[
    //migrate [dbo].[address_labels] to [dbo].[utl_Address_Label]
    {
        "Id": 1000,
        "Source": {
            "Tables": "[dbo].[address_labels] al",
            "OrderBy": "order by Address_ID"
        },
        "Destination": {
            "Tables": "utl_Address_Label"
        },
        "Map": {
            "(case when Attached_To = 'A' then 1 when Attached_To = 'C' then 6 else 0 end) ModuleID": "ModuleID",
            "1 LabelFormatType": "LabelFormatType",
            "convert(bigint,Attached_Record_ID) AttachedRecordNumber": "AttachedRecordNumber",
            "convert(bigint,Address_ID) AddressID": "AddressID",
            "Label_Line_1": "LabelLine1",
            "Label_Line_2": "LabelLine2",
            "Label_Line_3": "LabelLine3",
            "Label_Line_4": "LabelLine4",
            "Label_Line_5": "LabelLine5",
            "Label_Line_6": "LabelLine6",
            "Label_Line_7": "LabelLine7",
            "Label_Line_8": "LabelLine8"
        }
    },
    //migrate [dbo].[address] to [dbo].[utl_Address]
    {
        "Id": 1001,
        "Source": {
            "Tables": "[dbo].[address] a",
            "OrderBy": "order by Account_Number"
        },
        "Destination": {
            "Tables": "utl_Address"
        },
        "Map": {
            "(case when Attached_To = 'A' then 1 when Attached_To = 'C' then 6 else 0 end) ModuleID": "ModuleID",
            "convert(bigint,Account_Number) AccountNumber": "AccountNumber",
            "convert(bigint,Attached_Record_Number) AttachedRecordNumber": "AttachedRecordNumber",
            "Location_Name": "LocationName",
            "Attention_Name": "AttentionName",
            "convert(bigint,Attention_Contact_Number) AttentionContactNumber": "AttentionContactNumber",
            "Street_Line_1": "StreetLine1",
            "Street_Line_2": "StreetLine2",
            "Street_Line_3": "StreetLine3",
            "City": "City",
            "County": "County",
            "State": "State",
            "Postal_Code": "PostalCode",
            "Country": "Country",
            "Address_Type": "AddressType",
            "Accounting_Interface": "AccountingInterface",
            "Ship_To_ID": "ShipToID",
            "Address_Label_Format": "AddressLabelFormat",
            "(case when exists (select 1 from [dbo].[account] where Account_Number = a.Account_Number and Primary_Address_Record = a.Address_Record_Number) then 1 else 0 end) IsPrimaryAddress": "IsPrimaryAddress",
            "(case when exists (select 1 from [dbo].[account] where Account_Number = a.Account_Number and Primary_Bill_To_Address_ID = a.Address_Record_Number) then 1 else 0 end) IsPrimaryBillToAddress": "IsPrimaryBillToAddress",
            "(case when exists (select 1 from [dbo].[account] where Account_Number = a.Account_Number and Primary_Ship_To_Address_ID = a.Address_Record_Number) then 1 else 0 end) IsPrimaryShipToAddress": "IsPrimaryShipToAddress",
            "Address_Notes": "AddressNotes"
        }
    },
    //migrate [dbo].[phone] to [dbo].[fld_Multi_FieldValue]
    {
        "Id": 1002,
        "Source": {
            "Tables": "[dbo].[phone] p",
            "OrderBy": "order by Account_Number"
        },
        "Destination": {
            "Tables": "fld_Multi_FieldValue"
        },
        "NeedTruncate": false,
        "Map": {
            "(case when Phone_Medium = 'V' then 5 when Phone_Medium = 'F' then 6 else 0 end) FieldID": "FieldID",
            "convert(bigint,Account_Number) RecID": "RecID",
            "[tempdb].[dbo].[ConvertPhoneFax](Phone_Number,'') FieldVal": "FieldVal",
            "Extension": "Ext",
            "(case when exists (select 1 from [dbo].[account] where Account_Number = p.Account_Number and Attached_To = 'A' and ((Primary_Phone_Record = p.Phone_Record_Number and Phone_Medium = 'V') or (Primary_Fax_Record = p.Phone_Record_Number and Phone_Medium = 'F'))) then 1 else 0 end) IsPrimary": "IsPrimary",
            "Notes_Text": "Notes"
        }
    },
    //migrate [dbo].[net] to [dbo].[fld_Multi_FieldValue]
    {
        "Id": 1003,
        "Source": {
            "Tables": "[dbo].[net] n",
            "OrderBy": "order by Account_Number"
        },
        "Destination": {
            "Tables": "fld_Multi_FieldValue"
        },
        "NeedTruncate": false,
        "Map": {
            "(case when Address_Type = 'E' then 7 when Address_Type = 'W' then 8 else 0 end) FieldID": "FieldID",
            "convert(bigint,Account_Number) RecID": "RecID",
            "Net_Address": "FieldVal",
            "(case when exists (select 1 from [dbo].[account] where Account_Number = n.Account_Number and Attached_To = 'A' and ((Primary_Email_Record = n.Net_Record_Number and Address_Type = 'E') or (Primary_Fax_Record = n.Net_Record_Number and Address_Type = 'W'))) then 1 else 0 end) IsPrimary": "IsPrimary",
            "Notes_Text": "Notes"
        }
    },
    //migrate [adaptv3SAMPLE].[dbo].[account] to acc_Account
    {
        "Id": 1004,
        "Source": {
            "Tables": "[dbo].[account] acc",
            "OrderBy": "order by Account_Number"
        },
        "Destination": {
            "Tables": "acc_Account",
            "Script":  "QueryCRM_Update_Data_To_Custom_Field.txt"
        },
        "Map": {
            "convert(bigint,Account_Number) AccountNumber": "AccountNumber",
            "Account_Name": "AccountName",
            "Account_Full_Name": "AccountFullName",
            "Company_ID": "CompanyID",
            "Customer_Number": "CustomerNumber",
            "Vendor_Number": "VendorNumber",
            "convert(varchar(255),Account_Type) AccountTypeID": "AccountTypeID",
            "convert(varchar(255),Last_Primary_Source) LastPrimarySourceID": "LastPrimarySourceID",
            "convert(varchar(255),Last_Secondary_Source) LastSecondarySourceID": "LastSecondarySourceID",
            "convert(bigint,Last_Marketing_Campaign) LastMarketingCampaignID": "LastMarketingCampaignID",
            "convert(varchar(255),Last_Marketing_Event) LastMarketingEventID": "LastMarketingEventID",
            "Original_Primary_Source": "OriginalPrimarySourceID",
            "Original_Secondary_Source": "OriginalSecondarySourceID",
            "convert(int, Original_Marketing_Campaign) OriginalMarketingCampaignID": "OriginalMarketingCampaignID",
            "convert(int, Original_Marketing_Event) OriginalMarketingEventID": "OriginalMarketingEventID",
            "convert(varchar(255),Territory_ID) TerritoryID": "TerritoryID",
            "Business_Type": "BusinessTypeID",
            "Account_Manager_Syspro_GetUserID": "AccountManager",
            "Service_Manager_Syspro_GetUserID": "ServiceManagerID",
            //"Service_Contract_Number":  "",
            //"Last_Technician": "",
            //"Last_Service_Date": "",
            "convert(varchar(255),Support_Basis) SupportStatusID": "SupportStatusID",
            "Free_Support_Expires_Syspro_TF": "ReceivesFreeSupport",
            "[tempdb].[dbo].[GetDate](Free_Support_Expires_Date) ReceivesFreeSupportUntil": "ReceivesFreeSupportUntil",
            "convert(varchar(255),Service_Location) ServiceLocationID": "ServiceLocationID",
            "convert(varchar(255),Service_Portal_Access_Level) ServicePortalAccessLevel": "ServicePortalAccessLevel",
            "convert(bigint,Primary_Sales_Contact) PrimaryContactID": "PrimaryContactID",
            //"Primary_Service_Contact":  "",
            //"Primary_Collections_Contact": "",
            //"Secondary_Customer_Contact": "",
            //"Primary_Vendor_Contact": "",
            //"Secondary_Vendor_Contact": "",
            //"Last_Phone_Record": "",
            "([tempdb].[dbo].[ConvertPhoneFax]((select top 1 Phone_Number from [dbo].[phone] where Account_Number = acc.Account_Number and Phone_Record_Number = Primary_Phone_Record and Phone_Medium = 'V' and Attached_To = 'A'),(select top 1 Extension from [dbo].[phone] where Account_Number = Account_Number and Phone_Record_Number = Primary_Phone_Record and Phone_Medium = 'V' and Attached_To = 'A'))) TelephoneNumber": "TelephoneNumber",
            //"Phone_Count": "",
            "([tempdb].[dbo].[ConvertPhoneFax]((select top 1 Phone_Number from [dbo].[phone] where Account_Number = acc.Account_Number and Phone_Record_Number = Primary_Fax_Record and Phone_Medium = 'F' and Attached_To = 'A'),(select top 1 Extension from [dbo].[phone] where Account_Number = Account_Number and Phone_Record_Number = Primary_Fax_Record and Phone_Medium = 'F' and Attached_To = 'A'))) FaxNumber": "FaxNumber",
            //"Fax_Count": "",
            //"Last_Address_Record": "",
            "Location_Name_Syspro_Address": "AddressLocationName",
            "Street_Line_1_Syspro_Address": "AddressLine1",
            "Street_Line_2_Syspro_Address": "AddressLine2",
            "Street_Line_3_Syspro_Address": "AddressLine3",
            "City_Syspro_Address": "City",
            "County_Syspro_Address": "County",
            "State_Syspro_Address": "State",
            "Postal_Code_Syspro_Address": "PostalCode",
            "Country_Syspro_Address": "Country",
            "Address_Type_Syspro_Address": "AddressTypeID",
            "Address_Notes_Syspro_Address":  "AddressNotes",
            //"Primary_Address_Record": "",
            //"Primary_Bill_To_Address_ID": "",
            //"Primary_Ship_To_Address_ID": "",
            //"Address_Count": "",
            //"Last_Net_Record": "",
            "(select top 1 Net_Address from [dbo].[net] where Address_Type = 'E' and Account_Number = acc.Account_Number and Attached_To = 'A' and Attached_Record_Number = Primary_Email_Record) EmailAddress": "EmailAddress",
            //"Email_Count": "",
            "(select top 1 Net_Address from [dbo].[net] where Address_Type = 'W' and Account_Number = acc.Account_Number and Attached_To = 'A' and Attached_Record_Number = Primary_Web_Record) WebAddress": "WebAddress",
            //"Web_Count": "",
            //"Alert_Flag": "",
            "Active_Flag_Syspro_TF": "IsActiveAccount",
            "convert(varchar(255),Language) LanguageID": "LanguageID",
            "convert(bigint,Total_Activities) TotalActivities": "TotalActivities",
            "convert(decimal(15,4),Total_Sales) TotalSales": "TotalSales",
            //"Total_Open_Sales": "",
             "convert(decimal(15,4),Total_Lost_Sales) TotalLostSales": "TotalLostSales",
            "Open_Service_Tickets": "TotalOpenServiceTicket",
            "Closed_Service_Tickets": "TotalClosedServiceTicket",
            //"Last_Service_Contact": "",
            "convert(varchar(255),Last_Milestone) LastMilestoneID": "LastMilestoneID",
            "[tempdb].[dbo].[GetDate](Last_Milestone_Date) LastMilestoneDate": "LastMilestoneDate",
            "convert(varchar(255),Next_Milestone) NextMilestoneID": "NextMilestoneID",
            "convert(varchar(255),Tax_Schedule) TaxScheduleID": "TaxScheduleID",
            "convert(varchar(255),Payment_Terms) PaymentTermID": "PaymentTermID",
            "Credit_Hold_Syspro_TF": "IsCreditHold",
            //"Credit_Hold_Date": "",
            "convert(varchar(255),Shipping_Method) ShippingMethodID": "ShippingMethodID",
            "convert(varchar(255),FOB) FOBID": "FOBID",
            "convert(varchar(255),[tempdb].[dbo].[GetCurrencyCodeID](Currency_Code)) CurrencyCodeID": "CurrencyCodeID",
            "convert(varchar(255),Customer_Class) CustomerClassID": "CustomerClassID",
            "Do_Not_Call_Syspro_TF": "IsDoNotCall",
            "Do_Not_Fax_Syspro_TF": "IsDoNotFax",
            "Do_Not_Email_Syspro_TF": "IsDoNotEmail",
            "Do_Not_Mail_Syspro_TF": "IsDoNotMail",
            "Accounting_Branch": "Branch",
            "(select count(Contact_Number) from [dbo].[contact] where Account_Number = acc.Account_Number) TotalContact": "TotalContact",
            "(select count(Item_Owned_Record_ID) from [dbo].[acctitem] where Account_Number = acc.Account_Number) TotalItemOwned": "TotalItemOwned",
            "convert(decimal(15,4),(select count(Opportunity_Number) from [dbo].[oppty] where Account_Number = acc.Account_Number and Status = 1)) TotalOpenOpportunities": "TotalOpenOpportunities",
            "convert(decimal(15,4),(select count(Opportunity_Number) from [dbo].[oppty] where Account_Number = acc.Account_Number and Status = 4)) TotalPostedOpportunities": "TotalPostedOpportunities",
            "convert(decimal(15,4),(select count(Opportunity_Number) from [dbo].[oppty] where Account_Number = acc.Account_Number and Status = 5)) TotalCanceledOpportunities": "TotalCanceledOpportunities",
            "(select count(Contract_Number) from [dbo].[service_contracts] where Account_Number = acc.Account_Number and Contract_Status = 2) TotalActiveServiceContracts": "TotalActiveServiceContracts",
            "(select count(Contract_Number) from [dbo].[service_contracts] where Account_Number = acc.Account_Number and Contract_Status = 4) TotalExpiredServiceContracts": "TotalExpiredServiceContracts",
            "(select count(Goal_Record_ID) from [dbo].[sales_goals] where Account_Number = acc.Account_Number) TotalGoals": "TotalGoals",
            "(select top 1 ([tempdb].[dbo].[GetDateTime](Activity_Date,Activity_Time)) from [dbo].[act] where Account_Number = acc.Account_Number order by Activity_Date desc,Activity_Time desc) LastActivityDate": "LastActivityDate",
            "(select top 1 ([tempdb].[dbo].[GetDateTime](Start_Date,Start_Time)) from [dbo].[appt] where Account_Number = acc.Account_Number and Completed = 'F' ORDER BY Account_Number ASC ,Completed ASC ,Start_Date ASC ,Start_Time ASC ,Appointment_ID ASC) NextActivityDate":  "NextActivityDate",
            "Notes_Text": "Notes",
            "[tempdb].[dbo].[GetDateTime](Create_Date,Created_Time) Created_Date": "CreatedDate",
            "Create_User_Syspro_GetUserID": "CreatedBy",
            "Modified_Date": "ModifiedDate",
            "Modified_User_Syspro_GetUserID": "ModifiedBy"
        }
    }

]
